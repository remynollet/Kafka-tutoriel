asyncapi: '2.2.0'
info:
  title: myFunctionalEvent
  version: '1.0.0'
  description: | 
    This service publishes events when 
    it detect an operation on my data.
  license:  [...]
  contact: [...]

servers:
  stage:
    url: moncluster.aivencloud.com:12658
    protocol: kafka-secure
    description: Stage Aiven Broker Cluster

channels:
  mytopic_mydata_v1:
    subscribe:
      message:
        $ref: '#/components/messages/data'

components:
  messages:
    data:
      contentType: application/octet-stream
      schemaFormat: application/vnd.apache.avro+json;version=1.9.0
      traits:
        - $ref: './ce-cloud.yaml'
      payload:
        $ref: './schema.json#/SupplyShipmentSent'
      examples:
        - name: sample1
          summary: event of sample1
          headers:
            ce_specversion: '1.0.0'
            ce_type: 'com.decathlon.domain.data'
            ce_source: 'com.decathlon.domain.app'
            ce_id: "{{uuid()}}"
            ce_time: "{{now(yyyy-MM-dd'T'HH:mm:SS'Z')}}"
            content-type: application/avro
          payload:
            [...]